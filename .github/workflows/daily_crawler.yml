name: Hourly Ranking Update

on:
    repository_dispatch:
        types: [trigger-30m-cron]
    # 允許你手動按按鈕觸發 (方便測試)
    workflow_dispatch:

jobs:
    update-ranking:
        runs-on: ubuntu-latest

        steps:
            - name: Checkout code
              uses: actions/checkout@v3

            - name: Setup Node.js
              uses: actions/setup-node@v3
              with:
                  node-version: '18'

            - name: Install dependencies
              run: npm ci

            - name: Run script
              run: node fetch_all_rankings.js
              env:
                  # 把 GitHub Secrets 注入環境變數
                  SUPABASE_URL: ${{ secrets.SUPABASE_URL }}
                  SUPABASE_KEY: ${{ secrets.SUPABASE_KEY }}



